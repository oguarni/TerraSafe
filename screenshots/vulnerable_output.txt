🔐 TerraSafe - Intelligent Terraform Security Scanner
🤖 Using hybrid approach: Rules + ML Anomaly Detection

============================================================
🔍 TERRAFORM SECURITY SCAN RESULTS
============================================================
📁 File: test_files/vulnerable.tf
------------------------------------------------------------

❌ CRITICAL RISK
[91m📊 Final Risk Score: 80/100[0m
├─ Rule-based Score: 100/100
├─ ML Anomaly Score: 51.2/100
└─ Confidence: LOW

📋 Issue Summary:
   [91m🔴 Critical: 2[0m
   [93m🟠 High: 3[0m
   [94m🟡 Medium: 1[0m

🚨 Detected Vulnerabilities:
------------------------------------------------------------

[CRITICAL] Open security group - SSH port 22 exposed to internet
   📍 Resource: web_sg
   💡 Fix: Restrict SSH access to specific IP ranges

[MEDIUM] HTTP/HTTPS port 80 open to internet
   📍 Resource: web_sg
   💡 Fix: Consider using a CDN or WAF for public web services

[CRITICAL] Hardcoded password detected
   📍 Resource: Database/Instance
   💡 Fix: Use variables or secrets manager for sensitive data

[HIGH] Unencrypted RDS instance
   📍 Resource: main_db
   💡 Fix: Enable storage_encrypted = true

[HIGH] Unencrypted EBS volume
   📍 Resource: data_volume
   💡 Fix: Enable encrypted = true

[HIGH] S3 bucket with public access enabled
   📍 Resource: public_bucket
   💡 Fix: Enable all public access blocks

============================================================

📄 Detailed results saved to scan_results.json
