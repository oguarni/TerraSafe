ğŸ” TerraSafe - Intelligent Terraform Security Scanner
ğŸ¤– Using hybrid approach: Rules (60%) + ML Anomaly Detection (40%)

============================================================
ğŸ” TERRAFORM SECURITY SCAN RESULTS
============================================================
ğŸ“ File: test_files/vulnerable.tf
------------------------------------------------------------

âŒ HIGH RISK
[91mğŸ“Š Final Risk Score: 78/100[0m
â”œâ”€ Rule-based Score: 100/100
â”œâ”€ ML Anomaly Score: 45.5/100
â””â”€ Confidence: LOW

ğŸ”¬ Feature Analysis:
   Open Ports: 1
   Hardcoded Secrets: 1
   Public Access: 1
   Unencrypted Storage: 2

â±ï¸  Performance:
   Scan Time: 0.046s
   File Size: 1.7 KB

ğŸš¨ Detected Vulnerabilities:
------------------------------------------------------------

[CRITICAL] Open security group - SSH port 22 exposed to internet
   ğŸ“ Resource: web_sg
   ğŸ’¡ Fix: Restrict SSH access to specific IP ranges

[MEDIUM] HTTP/HTTPS port 80 open to internet
   ğŸ“ Resource: web_sg
   ğŸ’¡ Fix: Consider using a CDN or WAF for public web services

[CRITICAL] Hardcoded password detected
   ğŸ“ Resource: Database/Instance
   ğŸ’¡ Fix: Use variables or secrets manager for sensitive data

[HIGH] Unencrypted RDS instance
   ğŸ“ Resource: main_db
   ğŸ’¡ Fix: Enable storage_encrypted = true

[HIGH] Unencrypted EBS volume
   ğŸ“ Resource: data_volume
   ğŸ’¡ Fix: Enable encrypted = true

[HIGH] S3 bucket with public access enabled
   ğŸ“ Resource: public_bucket
   ğŸ’¡ Fix: Enable all public access blocks

============================================================

ğŸ“„ Scan results saved to scan_results_vulnerable.json
ğŸ“Š History updated in scan_history.json
