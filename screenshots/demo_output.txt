═══════════════════════════════════════════════════════
    TERRAFORM SECURITY SCANNER - DEMONSTRATION
═══════════════════════════════════════════════════════
Installing dependencies...

▶ TEST 1: HIGH RISK Configuration (vulnerable.tf)
═══════════════════════════════════════════════════════
🔐 TerraSafe - Intelligent Terraform Security Scanner
🤖 Using hybrid approach: Rules + ML Anomaly Detection

============================================================
🔍 TERRAFORM SECURITY SCAN RESULTS
============================================================
📁 File: test_files/vulnerable.tf
------------------------------------------------------------

❌ CRITICAL RISK
[91m📊 Final Risk Score: 80/100[0m
├─ Rule-based Score: 100/100
├─ ML Anomaly Score: 51.2/100
└─ Confidence: LOW

📋 Issue Summary:
   [91m🔴 Critical: 2[0m
   [93m🟠 High: 3[0m
   [94m🟡 Medium: 1[0m

🚨 Detected Vulnerabilities:
------------------------------------------------------------

[CRITICAL] Open security group - SSH port 22 exposed to internet
   📍 Resource: web_sg
   💡 Fix: Restrict SSH access to specific IP ranges

[MEDIUM] HTTP/HTTPS port 80 open to internet
   📍 Resource: web_sg
   💡 Fix: Consider using a CDN or WAF for public web services

[CRITICAL] Hardcoded password detected
   📍 Resource: Database/Instance
   💡 Fix: Use variables or secrets manager for sensitive data

[HIGH] Unencrypted RDS instance
   📍 Resource: main_db
   💡 Fix: Enable storage_encrypted = true

[HIGH] Unencrypted EBS volume
   📍 Resource: data_volume
   💡 Fix: Enable encrypted = true

[HIGH] S3 bucket with public access enabled
   📍 Resource: public_bucket
   💡 Fix: Enable all public access blocks

============================================================

📄 Detailed results saved to scan_results.json

▶ TEST 2: SECURE Configuration (secure.tf)
═══════════════════════════════════════════════════════
🔐 TerraSafe - Intelligent Terraform Security Scanner
🤖 Using hybrid approach: Rules + ML Anomaly Detection

============================================================
🔍 TERRAFORM SECURITY SCAN RESULTS
============================================================
📁 File: test_files/secure.tf
------------------------------------------------------------

✅ LOW RISK
[92m📊 Final Risk Score: 18/100[0m
├─ Rule-based Score: 0/100
├─ ML Anomaly Score: 46.1/100
└─ Confidence: LOW

[92m✅ No security issues detected![0m

============================================================

📄 Detailed results saved to scan_results.json

▶ TEST 3: MEDIUM RISK Configuration (mixed.tf)
═══════════════════════════════════════════════════════
🔐 TerraSafe - Intelligent Terraform Security Scanner
🤖 Using hybrid approach: Rules + ML Anomaly Detection

============================================================
🔍 TERRAFORM SECURITY SCAN RESULTS
============================================================
📁 File: test_files/mixed.tf
------------------------------------------------------------

✅ LOW RISK
[92m📊 Final Risk Score: 31/100[0m
├─ Rule-based Score: 20/100
├─ ML Anomaly Score: 48.5/100
└─ Confidence: LOW

📋 Issue Summary:
   [94m🟡 Medium: 2[0m

🚨 Detected Vulnerabilities:
------------------------------------------------------------

[MEDIUM] HTTP/HTTPS port 80 open to internet
   📍 Resource: app_sg
   💡 Fix: Consider using a CDN or WAF for public web services

[MEDIUM] S3 bucket with partial public access
   📍 Resource: app_bucket
   💡 Fix: Review and restrict public access settings

============================================================

📄 Detailed results saved to scan_results.json

═══════════════════════════════════════════════════════
✓ Security analysis completed for all configurations!

Summary:
  • vulnerable.tf: Multiple critical issues detected
  • secure.tf: Follows security best practices
  • mixed.tf: Some improvements recommended
═══════════════════════════════════════════════════════
