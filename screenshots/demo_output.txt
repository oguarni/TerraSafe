â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    TERRAFORM SECURITY SCANNER - DEMONSTRATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Installing dependencies...

â–¶ TEST 1: HIGH RISK Configuration (vulnerable.tf)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” TerraSafe - Intelligent Terraform Security Scanner
ğŸ¤– Using hybrid approach: Rules + ML Anomaly Detection

============================================================
ğŸ” TERRAFORM SECURITY SCAN RESULTS
============================================================
ğŸ“ File: test_files/vulnerable.tf
------------------------------------------------------------

âŒ CRITICAL RISK
[91mğŸ“Š Final Risk Score: 80/100[0m
â”œâ”€ Rule-based Score: 100/100
â”œâ”€ ML Anomaly Score: 51.2/100
â””â”€ Confidence: LOW

ğŸ“‹ Issue Summary:
   [91mğŸ”´ Critical: 2[0m
   [93mğŸŸ  High: 3[0m
   [94mğŸŸ¡ Medium: 1[0m

ğŸš¨ Detected Vulnerabilities:
------------------------------------------------------------

[CRITICAL] Open security group - SSH port 22 exposed to internet
   ğŸ“ Resource: web_sg
   ğŸ’¡ Fix: Restrict SSH access to specific IP ranges

[MEDIUM] HTTP/HTTPS port 80 open to internet
   ğŸ“ Resource: web_sg
   ğŸ’¡ Fix: Consider using a CDN or WAF for public web services

[CRITICAL] Hardcoded password detected
   ğŸ“ Resource: Database/Instance
   ğŸ’¡ Fix: Use variables or secrets manager for sensitive data

[HIGH] Unencrypted RDS instance
   ğŸ“ Resource: main_db
   ğŸ’¡ Fix: Enable storage_encrypted = true

[HIGH] Unencrypted EBS volume
   ğŸ“ Resource: data_volume
   ğŸ’¡ Fix: Enable encrypted = true

[HIGH] S3 bucket with public access enabled
   ğŸ“ Resource: public_bucket
   ğŸ’¡ Fix: Enable all public access blocks

============================================================

ğŸ“„ Detailed results saved to scan_results.json

â–¶ TEST 2: SECURE Configuration (secure.tf)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” TerraSafe - Intelligent Terraform Security Scanner
ğŸ¤– Using hybrid approach: Rules + ML Anomaly Detection

============================================================
ğŸ” TERRAFORM SECURITY SCAN RESULTS
============================================================
ğŸ“ File: test_files/secure.tf
------------------------------------------------------------

âœ… LOW RISK
[92mğŸ“Š Final Risk Score: 18/100[0m
â”œâ”€ Rule-based Score: 0/100
â”œâ”€ ML Anomaly Score: 46.1/100
â””â”€ Confidence: LOW

[92mâœ… No security issues detected![0m

============================================================

ğŸ“„ Detailed results saved to scan_results.json

â–¶ TEST 3: MEDIUM RISK Configuration (mixed.tf)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” TerraSafe - Intelligent Terraform Security Scanner
ğŸ¤– Using hybrid approach: Rules + ML Anomaly Detection

============================================================
ğŸ” TERRAFORM SECURITY SCAN RESULTS
============================================================
ğŸ“ File: test_files/mixed.tf
------------------------------------------------------------

âœ… LOW RISK
[92mğŸ“Š Final Risk Score: 31/100[0m
â”œâ”€ Rule-based Score: 20/100
â”œâ”€ ML Anomaly Score: 48.5/100
â””â”€ Confidence: LOW

ğŸ“‹ Issue Summary:
   [94mğŸŸ¡ Medium: 2[0m

ğŸš¨ Detected Vulnerabilities:
------------------------------------------------------------

[MEDIUM] HTTP/HTTPS port 80 open to internet
   ğŸ“ Resource: app_sg
   ğŸ’¡ Fix: Consider using a CDN or WAF for public web services

[MEDIUM] S3 bucket with partial public access
   ğŸ“ Resource: app_bucket
   ğŸ’¡ Fix: Review and restrict public access settings

============================================================

ğŸ“„ Detailed results saved to scan_results.json

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ“ Security analysis completed for all configurations!

Summary:
  â€¢ vulnerable.tf: Multiple critical issues detected
  â€¢ secure.tf: Follows security best practices
  â€¢ mixed.tf: Some improvements recommended
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
