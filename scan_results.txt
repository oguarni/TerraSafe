🔐 TerraSafe - Intelligent Terraform Security Scanner
🤖 Using hybrid approach: Rules (60%) + ML Anomaly Detection (40%)

============================================================
🔍 TERRAFORM SECURITY SCAN RESULTS
============================================================
📁 File: test_files/vulnerable.tf
------------------------------------------------------------

❌ CRITICAL RISK
[91m📊 Final Risk Score: 80/100[0m
├─ Rule-based Score: 100/100
├─ ML Anomaly Score: 52.4/100
└─ Confidence: LOW

🔬 Feature Analysis:
   Open Ports: 1
   Hardcoded Secrets: 1
   Public Access: 1
   Unencrypted Storage: 2

📋 Issue Summary:
   [91m🔴 Critical: 2[0m
   [93m🟠 High: 3[0m
   [94m🟡 Medium: 1[0m

🚨 Detected Vulnerabilities:
------------------------------------------------------------

[CRITICAL] Open security group - SSH port 22 exposed to internet
   📍 Resource: web_sg
   💡 Fix: Restrict SSH access to specific IP ranges

[MEDIUM] HTTP/HTTPS port 80 open to internet
   📍 Resource: web_sg
   💡 Fix: Consider using a CDN or WAF for public web services

[CRITICAL] Hardcoded password detected
   📍 Resource: Database/Instance
   💡 Fix: Use variables or secrets manager for sensitive data

[HIGH] Unencrypted RDS instance
   📍 Resource: main_db
   💡 Fix: Enable storage_encrypted = true

[HIGH] Unencrypted EBS volume
   📍 Resource: data_volume
   💡 Fix: Enable encrypted = true

[HIGH] S3 bucket with public access enabled
   📍 Resource: public_bucket
   💡 Fix: Enable all public access blocks

============================================================

📄 Detailed results saved to scan_results.json
🔐 TerraSafe - Intelligent Terraform Security Scanner
🤖 Using hybrid approach: Rules (60%) + ML Anomaly Detection (40%)

============================================================
🔍 TERRAFORM SECURITY SCAN RESULTS
============================================================
📁 File: test_files/secure.tf
------------------------------------------------------------

✅ LOW RISK
[92m📊 Final Risk Score: 17/100[0m
├─ Rule-based Score: 0/100
├─ ML Anomaly Score: 43.3/100
└─ Confidence: MEDIUM

🔬 Feature Analysis:
   Open Ports: 0
   Hardcoded Secrets: 0
   Public Access: 0
   Unencrypted Storage: 0

[92m✅ No security issues detected![0m
✓ All resources properly configured
✓ Encryption enabled where required
✓ Network access properly restricted

============================================================

📄 Detailed results saved to scan_results.json
🔐 TerraSafe - Intelligent Terraform Security Scanner
🤖 Using hybrid approach: Rules (60%) + ML Anomaly Detection (40%)

============================================================
🔍 TERRAFORM SECURITY SCAN RESULTS
============================================================
📁 File: test_files/mixed.tf
------------------------------------------------------------

✅ LOW RISK
[92m📊 Final Risk Score: 30/100[0m
├─ Rule-based Score: 20/100
├─ ML Anomaly Score: 46.8/100
└─ Confidence: LOW

🔬 Feature Analysis:
   Open Ports: 0
   Hardcoded Secrets: 0
   Public Access: 1
   Unencrypted Storage: 0

📋 Issue Summary:
   [94m🟡 Medium: 2[0m

🚨 Detected Vulnerabilities:
------------------------------------------------------------

[MEDIUM] HTTP/HTTPS port 80 open to internet
   📍 Resource: app_sg
   💡 Fix: Consider using a CDN or WAF for public web services

[MEDIUM] S3 bucket with partial public access
   📍 Resource: app_bucket
   💡 Fix: Review and restrict public access settings

============================================================

📄 Detailed results saved to scan_results.json
